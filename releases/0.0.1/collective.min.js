/*!-----------------------------------------------------------------------------
 * Collective JS â€” Manage Javascript Collections
 * v0.0.1 - built 2016-12-06
 * Licensed under the MIT License.
 * http://collective-js.jaysalvat.com/
 * ----------------------------------------------------------------------------
 * Copyright (C) 2016 Jay Salvat
 * http://jaysalvat.com/
 * --------------------------------------------------------------------------*/
!function(t,e){"use strict";"undefined"!=typeof module&&module.exports?module.exports=e():"function"==typeof define&&define.amd?define([],e):t.Collective=e()}(this,function(){"use strict";function t(t,e){return void 0===t?e:t}function e(t){return Array.isArray(t)?t:[t]}function n(t,e){return JSON.stringify(t)===JSON.stringify(e)}function i(n,i){return n=JSON.parse(JSON.stringify(n)),n=t(n.collection,n),n=i?e(n):n,r(n,!0),n}function r(t,n){var i=e(t).every(function(t){return"[object Object]"==={}.toString.call(t)});if(!i&&n)throw new Error("Collective only accepts Array/Objects.");return i}var c=function(t){return this instanceof c?(t instanceof Function&&(t=t()),this.collection=i(t),this.length=this.collection.length,void(this.events={})):new c(t)};return c.path=function(t,e){return e=(e||"").split("."),e.reduce(function(t,e){var n,i=/(.*?)\[(.*?)\]$/g.exec(e);i&&(e=i[1],n=i[2]);try{return void 0!==n?t[e][n]:t[e]}catch(t){return}},t)},c.object=function(e,n,i){var r,c,o;if(e=(e||"").split("."),i&&(e.shift(),!e.length))return n;for(;e.length;)o=e.pop(),r={},r[o]=t(c,n),c=r;return r},c.dot=function(t,e){return e=e||[],Object.keys(t).forEach(function(n){if(e.push(n),"object"==typeof t[n])return c.dot(t[n],e)}),e.join(".")},c.extend=function(t){for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(null!==i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},c.prototype={all:function(){return this.collection},set:function(t,e){var n=this.collection.slice();e=i(e),n[t]=e;var r=this.clone(n);return this.trigger("update",[e],r),r},get:function(t){return this.collection[t]||{}},first:function(){return this.get(0)},last:function(){return this.get(this.collection.length-1)},prop:function(t){return this.get(0)[t]},find:function(t){return this.where(t).first()},fields:function(i){var r=[];i=e(i),this.collection.forEach(function(e){var n={};i.forEach(function(i){n[i]=t(e[i],null)}),r.push(n)});var c=this.clone(r);return n(r,this.collection)||this.trigger("update",r,c),c},pluck:function(n,i,r,o){var u=[],l={},s=!!i;return n=e(n),i=e(i),r=t(r,"{0}"),o=t(o,"{0}"),this.collection.forEach(function(t){var e=r,s=o;n.forEach(function(n,i){var r=c.path(t,n)||"";e=e.replace(new RegExp("\\{"+i+"\\}","g"),r)}),i.forEach(function(e,n){var i=c.path(t,e)||"";s=s.replace(new RegExp("\\{"+n+"\\}","g"),i)}),u.push(e),l[e]=s}),s?l:u},sort:function(t){var e=this.collection.slice();e="function"==typeof t?e.sort(t):e.sort(function(e,n){var i,r,o,u,l,s=Object.keys(t);for(i=0;i<s.length;i++){if(r=s[i],o=t[r],u=c.path(e,r),l=c.path(n,r),o||(o=-1),void 0===u)return 0;if(u<l)return o*-1;if(u>l)return o}return 0});var i=this.clone(e);return n(e,this.collection)||this.trigger("sort",t,i),i},uniq:function(){var t,e=this;return t=this.collection.filter(function(t,n){return e.index(t)===n}),this.clone(t)},where:function(t,n){var i=[],r=this.collection.slice();return n=n||{},t=e(t),r=r.filter(function(e,r){var o,u=n.exclude;for(o=0;o<t.length;o++){var l,s=t[o],f=Object.keys(s),h=!n.exclude;if(Number.isInteger(s)){if(s!==r){h=n.exclude;break}}else for(l=0;l<f.length;l++){var a=f[l],p=s[a],d=c.path(e,a);if("function"==typeof p){p.call(this,d,a)||(h=n.exclude);break}if(void 0===p||d!==p){h=n.exclude;break}}if(u=h,h!==n.exclude){i.indexOf(r)<0&&i.push(r);break}}return u}),n.indexes?i:this.clone(r)},add:function(t,e,n){var r=this.collection.slice();e=i(e,!0),e.forEach(function(e){"splice"===t?r.splice(n,0,e):r[t](e)});var c=this.clone(r);return this.trigger("add",e,c),c},append:function(t){return this.add("push",t)},prepend:function(t){return this.add("unshift",t)},before:function(t,e){return this.add("splice",e,this.index(t))},after:function(t,e){return this.add("splice",e,this.index(t)+1)},update:function(t,e,n){var i=this,r=this.collection.slice(),o=[];e&&e!==!0?this.where(t,{indexes:!0}).forEach(function(t){n?r[t]=e:c.extend(r[t],e),o.push(r[t])}):(e=t,this.collection.forEach(function(t,r){i.update(r,e,n)}));var u=this.clone(r);return o.length&&this.trigger("update",o,u),u},replace:function(t,e){return this.update(t,e,!0)},remove:function(t){var e=this.where(t).all(),n=this.where(t,{exclude:!0});return e.length&&this.trigger("remove",e,n),n},on:function(t,e){return this.events[t]=this.events[t]||[],this.events[t].push(e),this},off:function(t,e){return this.events[t]=(this.events[t]||[]).filter(function(t){return t!==e}),this},trigger:function(t,e,n){var i=this.events.change||[],r=this.events[t]||[],c=i.concat(r);return n=n||this,c.forEach(function(i){i.call(n,e,t)}),n},clone:function(t){var e=Object.create(this);return e.collection=t?t.slice():this.collection.slice(),e.length=e.collection.length,e},transfer:function(t){function e(t,n){var i={};return Object.keys(t).forEach(function(r){var o,u=r.split(".")[0];"object"==typeof t[r]?o=e(t[r],n):"string"==typeof t[r]&&(o=c.path(n,t[r])),i[u]=c.object(r,o,!0)}),i}var i=[];this.collection.forEach(function(n){i.push(e(t,n))});var r=this.clone(i);return n(i,this.collection)||this.trigger("update",i,r),r},chunk:function(t){var e,n,i=[];for(t=t||5,n=Math.ceil(this.collection.length/t),e=0;e<n;e++)i.push(this.collection.slice(e*t,e*t+t));return i},index:function(t){return this.where(t,{indexes:!0})[0]},indexOf:function(t,e,n){var i,r=-1,c=this.collection.length;for(e=e||0,i=e;i<c;i++){var o,u=!0,l=n?c-i+e-1:i,s=this.collection[l],f=Object.keys(t),h=Object.keys(s);for(o=0;o<f.length;o++)if(t[f[o]]!==s[f[o]]){u=!1;break}for(o=0;o<h.length;o++)if(t[h[o]]!==s[h[o]]){u=!1;break}if(u){r=l;break}}return r},lastIndexOf:function(t,e){return this.indexOf(t,e,!0)},includes:function(t){return this.indexOf(t)>-1},join:function(t,e){return this.pluck(t).join(e)}},["forEach","filter","slice","concat","map","reverse"].forEach(function(t){c.prototype[t]=function(){var e=this.collection[t].apply(this.collection,[].slice.call(arguments));return this.clone(e)}}),["pop","shift","push","unshift","every","some","reduce","splice","fill"].forEach(function(t){c.prototype[t]=function(){var e=this.collection[t].apply(this.collection,[].slice.call(arguments));return this.length=this.collection.length,e}}),c});
//# sourceMappingURL=maps/collective.min.js.map
